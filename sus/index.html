<!DOCTYPE html>
<html>
<head>
    <title>Built‑In CSV + SQL Runner</title>
    <style>
        body { font-family: Arial; background: #fcf9d6; padding: 20px; }
        input[type=text] { width: 120px; margin-right: 5px; }
        button { padding: 8px 14px; margin: 5px; background: #c7dfd1; border-radius: 6px; }
        #resultBox { width: 100%; height: 200px; background: white; border: 1px solid black; overflow: auto; }
        #tableContainer { max-height: 200px; overflow: auto; border:1px solid #444; background:white; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #aaa; padding: 6px; text-align: left; }
        .prebuiltBox { margin-top: 10px; }
    </style>
</head>
<body>

<h2>Built‑In LEGO CSV</h2>
<p>This page loads the CSV automatically — no upload required.</p>

<!-- Input Fields -->
<div>
    <input type="text" id="nameField" placeholder="Name (max 25)">
    <input type="text" id="idField" placeholder="ID">
    <input type="text" id="pieceField" placeholder="Piece Count">
    <input type="text" id="yearField" placeholder="Year">
    <input type="text" id="priceField" placeholder="Price">
    <input type="text" id="themeField" placeholder="Theme">
    <input type="text" id="ppField" placeholder="Piece per $">
    <button id="addBtn">Create New</button>
</div>

<br>

<div id="tableContainer"></div>
<br>

<!-- SQL Runner -->
<textarea id="sqlInput" style="width:300px;height:120px;"></textarea>
<button id="runSqlBtn" style="background:#bfe1d4;font-size:16px;">Run SQL</button>
<div id="resultBox"></div>

<h3>Prebuilt SQL Queries</h3>
<div class="prebuiltBox">
    <button class="prebuilt" data-sql="SELECT * FROM data">Show All</button>
    <button class="prebuilt" data-sql="SELECT * FROM data WHERE Price > 100">Sets Price > 100</button>
    <button class="prebuilt" data-sql="SELECT * FROM data WHERE Year > 2020">Newer Than 2020</button>
    <button class="prebuilt" data-sql="SELECT Name, Theme FROM data">Names & Themes</button>
    <button class="prebuilt" data-sql="SELECT * FROM data ORDER BY PieceCount DESC">Sort by Piece Count</button>
    <button class="prebuilt" data-sql="SELECT * FROM data ORDER BY Price DESC">Sort by Price</button>
    <button class="prebuilt" data-sql="SELECT * FROM data WHERE Theme = 'Star Wars'">Theme = Star Wars</button>
    <button class="prebuilt" data-sql="SELECT * FROM data WHERE PiecePerDollar < 10">Best Value Sets</button>
</div>

<script>
// BUILT‑IN CSV CONTENT (from uploaded file)
let builtInCSV = `Set Name,Set ID,Pieces,Year,Price (MSRP),Theme,Pieces per Dollar
Millennium Falcon (UCS),75192,7541,2017,$799.99,Star Wars,9.43
Hogwarts Castle,71043,6020,2018,$399.99,Harry Potter,15.05
Ninjago City,70620,4867,2017,$299.99,Ninjago,16.22
Assembly Square,10255,4002,2017,$279.99,Creator Expert,14.29
The Lord of the Rings: Rivendell,10316,6167,2023,$499.99,LOTR,12.33
Death Star (Playset),75159,4016,2016,$499.99,Star Wars,8.03
Colosseum,10276,9036,2020,$549.99,Icons,16.43
Roman Colosseum (Architecture),21044,1036,2019,$99.99,Architecture,10.36
The Daily Bugle,76178,3772,2021,$349.99,Marvel,10.77
Ghostbusters Firehouse HQ,75827,4634,2016,$349.99,Ghostbusters,13.24
NASA Apollo Saturn V,21309,1969,2017,$119.99,Ideas,16.41
Imperial Star Destroyer (UCS),75252,4784,2019,$699.99,Star Wars,6.84
Titanic,10294,9090,2021,$679.99,Icons,13.37
Eiffel Tower,10307,10001,2022,$629.99,Icons,15.87
Technic Liebherr R 9800,42100,4108,2019,$449.99,Technic,9.13
Disney Castle,71040,4080,2016,$349.99,Disney,11.66
Parisian Restaurant,10243,2469,2014,$159.99,Creator Expert,15.43
Tree House,21318,3036,2019,$199.99,Ideas,15.18
Taj Mahal,10256,5923,2017,$369.99,Icons,16.01
Taj Mahal (2008),10189,5922,2008,$299.99,Creator Expert,19.74
Roller Coaster,10261,4124,2018,$379.99,Creator Expert,10.85
Pirates of Barracuda Bay,21322,2545,2020,$199.99,Ideas,12.73
NASA Space Shuttle Discovery,10283,2354,2021,$199.99,Icons,11.77
Central Perk,21319,1070,2019,$59.99,Ideas,17.83
Motorized Lighthouse,21335,2065,2022,$299.99,Ideas,6.88
Medieval Blacksmith,21325,2164,2021,$149.99,Ideas,14.43
Yoda,75255,1771,2019,$99.99,Star Wars,17.71
AT-AT (UCS),75313,6785,2021,$799.99,Star Wars,8.48
The Razor Crest,75331,6187,2022,$599.99,Star Wars,10.31
Mos Eisley Cantina,75290,3187,2020,$349.99,Star Wars,9.1
Home Alone House,21330,3955,2021,$249.99,Ideas,15.82
NES Console,71374,2646,2020,$229.99,Nintendo,11.51
Bowser,71411,2807,2022,$269.99,Nintendo,10.4
The Mighty Bowser,71427,1722,2023,$99.99,Nintendo,17.22
Statue of Liberty,21042,1685,2018,$119.99,Architecture,14.04
City Passenger Train,60197,677,2018,$159.99,City,4.23
City Cargo Train,60198,1226,2018,$229.99,City,5.33
Boutique Hotel,10297,3066,2022,$229.99,Modular,13.34
Sanctum Sanctorum,76218,2708,2022,$249.99,Marvel,10.83
Shield Helicarrier,76042,2996,2015,$349.99,Marvel,8.56
Avengers Tower,76269,5201,2023,$499.99,Marvel,10.4
Old Trafford – Man United,10272,3898,2020,$299.99,Icons,12.99
Barcelona Camp Nou,10284,5509,2021,$349.99,Icons,15.74
Ghostbusters Ecto-1,10274,2352,2020,$199.99,Ghostbusters,11.76
Bonsai Tree,10281,878,2021,$49.99,Botanical,17.56
Flower Bouquet,10280,756,2021,$59.99,Botanical,12.6
Optimus Prime,10302,1508,2022,$169.99,Transformers,8.87
The Simpsons House,71006,2523,2014,$199.99,Simpsons,12.61
The Kwik-E-Mart,71016,2179,2015,$199.99,Simpsons,10.89
Disney Train & Station,71044,2925,2019,$329.99,Disney,8.87
City Fire Station,60110,919,2016,$99.99,City,9.19
Police Station,60246,743,2020,$99.99,City,7.43
Arctic Icebreaker,60062,717,2014,$129.99,City,5.52
Volcano Explorers Base,60124,824,2016,$119.99,City,6.86
Ninjago City Gardens,71741,5685,2021,$299.99,Ninjago,18.95
Ninjago City Markets,71799,6163,2023,$369.99,Ninjago,16.66
Destiny’s Bounty (2017),70618,2295,2017,$159.99,Ninjago,14.34
Destiny’s Bounty (2020),71705,1260,2020,$129.99,Ninjago,9.69
Lloyd’s Titan Mech,70676,840,2019,$79.99,Ninjago,10.5
Dragonpit,70655,1660,2018,$129.99,Ninjago,12.77
Hogwarts Express Collector’s Edition,76405,5129,2022,$499.99,Harry Potter,10.26
Diagon Alley,75978,5544,2020,$399.99,Harry Potter,13.86
Hogwarts Great Hall,75954,878,2018,$99.99,Harry Potter,8.78
Hagrid’s Hut,75947,496,2019,$59.99,Harry Potter,8.27
The Burrow,75980,1047,2020,$99.99,Harry Potter,10.47
Medieval Castle,31120,1426,2021,$99.99,Creator 3-in-1,14.26
Creator Pirate Ship,31109,1260,2020,$99.99,Creator,12.6
Pirate Ship (2009),6243,592,2009,$89.99,Pirates,6.58
Imperial Flagship,10210,1664,2010,$179.99,Pirates,9.24
London Bus,10258,1686,2017,$139.99,Icons,12.05
Tower Bridge,10214,4287,2010,$239.99,Creator Expert,17.86
Big Ben,10253,4163,2016,$249.99,Architecture,16.65
Statue of Liberty (2000),3450,298,2000,$199.99,Sculptures,1.49
Grand Piano,21323,3662,2020,$349.99,Ideas,10.46
Jazz Club,10312,2899,2023,$229.99,Modular,12.6
Police Station Modular,10278,2923,2021,$199.99,Modular,14.62
Bookshop Modular,10270,2504,2020,$179.99,Modular,13.91
Corner Garage,10264,2569,2019,$199.99,Modular,12.85
Detective’s Office,10246,2262,2015,$159.99,Modular,14.14
Parisian Restaurant,10243,2469,2014,$159.99,Modular,15.43
Santa’s Visit,10293,1445,2021,$99.99,Winter Village,14.45
Elf Club House,10275,1197,2020,$99.99,Winter Village,11.97
Gingerbread House,10267,1477,2019,$99.99,Winter Village,14.78
Minecraft Mountain Cave,21137,2863,2017,$249.99,Minecraft,11.45
Minecraft Village,21128,1600,2016,$199.99,Minecraft,8
Minecraft Ocean Monument,21136,1122,2017,$119.99,Minecraft,9.35
Technic Porsche 911 GT3 RS,42056,2704,2016,$299.99,Technic,9.01
Technic Bugatti Chiron,42083,3599,2018,$349.99,Technic,10.29
Technic Lamborghini Sián,42115,3696,2020,$379.99,Technic,9.72
Technic Ferrari Daytona SP3,42143,3778,2022,$449.99,Technic,8.39
Technic BMW M 1000 RR,42130,1920,2021,$229.99,Technic,8.35
Friends Heartlake City Resort,41347,1017,2018,$99.99,Friends,10.17
Friends Tree House,41703,1114,2022,$79.99,Friends,13.92
Friends Main Street Building,41704,1682,2022,$159.99,Friends,10.51
Creator Expert Ferris Wheel,10247,2464,2015,$199.99,Creator Expert,12.32
Creator Expert Carousel,10257,2670,2017,$199.99,Creator Expert,13.35`; // Paste the actual CSV rows after this line.

// In‑memory database
let tableData = [];

function parseCSV(text) {
    let lines = text.trim().split("\n");
    let headers = lines[0].split(",").map(h => h.trim());

    return lines.slice(1).map(line => {
        let values = line.split(",");
        let obj = {};
        headers.forEach((h,i)=> obj[h] = values[i] ? values[i].trim() : "");
        return obj;
    });
}

function renderTable() {
    if (tableData.length === 0) {
        document.getElementById("tableContainer").innerHTML = "<i>No data loaded.</i>";
        return;
    }

    let cols = Object.keys(tableData[0]);

    let nameCol = cols.find(c => c.toLowerCase() === "name");
    let idCol   = cols.find(c => c.toLowerCase() === "id");

    let ordered = [];
    if (nameCol) ordered.push(nameCol);
    if (idCol) ordered.push(idCol);
    cols.forEach(c => { if (c !== nameCol && c !== idCol) ordered.push(c); });

    let html = "<table><tr>";
    ordered.forEach(c => html += `<th>${c}</th>`);
    html += "</tr>";

    tableData.forEach(row => {
        html += "<tr>";
        ordered.forEach(c => html += `<td>${row[c] ?? ""}</td>`);
        html += "</tr>";
    });
    html += "</table>";

    document.getElementById("tableContainer").innerHTML = html;
}

// Simple SQL engine
function runSQL(sql) {
    sql = sql.trim().toUpperCase();

    if (sql === "SELECT * FROM DATA") return tableData;

    if (sql.includes("WHERE")) {
        let condition = sql.split("WHERE")[1].trim();
        let [col, op, value] = condition.split(" ");
        value = value.replace(/'/g, "");

        return tableData.filter(r => {
            let v = r[col];
            if (!v) return false;
            if (!isNaN(v)) v = parseFloat(v);
            if (!isNaN(value)) value = parseFloat(value);

            if (op === "=") return v == value;
            if (op === ">") return v > value;
            if (op === "<") return v < value;
            return false;
        });
    }

    if (sql.includes("ORDER BY")) {
        let col = sql.split("ORDER BY")[1].trim();
        return [...tableData].sort((a,b) => (a[col] > b[col] ? -1 : 1));
    }

    return [{ Error: "Unsupported SQL" }];
}

// ADD NEW ROW
window.onload = function() {
    tableData = parseCSV(builtInCSV);
    renderTable();
};

document.getElementById("addBtn").addEventListener("click", function () {
    let name = document.getElementById("nameField").value;
    if (name.length > 25) return alert("Name ≤ 25 chars");

    let newRow = {
        ID: document.getElementById("idField").value,
        Name: name,
        PieceCount: document.getElementById("pieceField").value,
        Year: document.getElementById("yearField").value,
        Price: document.getElementById("priceField").value,
        Theme: document.getElementById("themeField").value,
        PiecePerDollar: document.getElementById("ppField").value
    };

    tableData.push(newRow);
    renderTable();
});

document.getElementById("runSqlBtn").addEventListener("click", function () {
    let sql = document.getElementById("sqlInput").value;
    let result = runSQL(sql);

    // Update table with SQL result
    tableData = Array.isArray(result) ? result : [];
    renderTable();

    document.getElementById("resultBox").innerText = JSON.stringify(result, null, 2);
});

document.querySelectorAll(".prebuilt").forEach(btn => {
    btn.addEventListener("click", function () {
        let sql = this.dataset.sql;
        document.getElementById("sqlInput").value = sql;
        document.getElementById("runSqlBtn").click();
    });
});

</script>

</body>
</html>

</body>
</html>
